---
- MiqPolicySet:
    name: 587352f0-fb88-11de-a067-005056ba0614
    description: 'Compliance: Hosts'
    set_type: MiqPolicySet
    guid: 587352f0-fb88-11de-a067-005056ba0614
    read_only: 
    set_data:
      :notes: This policy profile validates that an ESX host meets the standard defined
        in VMWare's security hardening documentation
    mode: pr
    owner_type: 
    owner_id: 
    userid: 
    group_id: 
    MiqPolicy:
    - name: eb84f288-fa39-11de-83ca-005056ba0614
      description: Protect Root File System Filling /home
      expression: 
      towhat: Host
      guid: eb84f288-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /home directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 62447a1a-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /home
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^[^#]*\\/home"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/fstab"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 62447a1a-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000019
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /home.
        read_only: 
    - name: 04db603c-fa3a-11de-83ca-005056ba0614
      description: Firewall - Outgoing Security Level
      expression: 
      towhat: Host
      guid: 04db603c-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of outgoing TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 1778fb28-fa44-11de-83ca-005056ba0614
        description: Valid Outgoing UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427,123,902'
              field: Host-enabled_udp_outbound_ports
        towhat: Host
        file_mtime: 
        guid: 1778fb28-fa44-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing UDP ports are 123,427,
          and 902.
        read_only: 
      - name: f0afd7d6-fa3a-11de-83ca-005056ba0614
        description: Valid Outgoing TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,427,443,27000,27010'
              field: Host-enabled_tcp_outbound_ports
        towhat: Host
        file_mtime: 
        guid: f0afd7d6-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000020
        notes: This condition verifies that the only open outgoing TCP ports are 427,443,902,27000,
          and 27010.
        read_only: 
    - name: af2d74ea-fa39-11de-83ca-005056ba0614
      description: Firewall - Incoming Security Level
      expression: 
      towhat: Host
      guid: af2d74ea-fa39-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only a defined set of incoming TCP and UDP
        Ports are open.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: b4a0843a-fa43-11de-83ca-005056ba0614
        description: Valid Incoming UDP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '427'
              field: Host-enabled_udp_inbound_ports
        towhat: Host
        file_mtime: 
        guid: b4a0843a-fa43-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming UDP port is 427.
        read_only: 
      - name: 03529e9e-f961-11de-9e9d-0050568a07c7
        description: Valid Incoming TCP Ports
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: '902,80,443,427,5989,22,5988'
              field: Host-enabled_tcp_inbound_ports
        towhat: Host
        file_mtime: 
        guid: 03529e9e-f961-11de-9e9d-0050568a07c7
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000021
        notes: This condition verifies that the only open incoming TCP ports are 22,80,427,443,902,5988,and
          5989.
        read_only: 
    - name: 61b355f2-fee1-11de-83dd-005056ba5e76
      description: Network - Forged Transmits Must Be Disabled
      expression: 
      towhat: Host
      guid: 61b355f2-fee1-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy insures that forged transmits are disabled on both vLans
        and vSwitches.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: f246e3e0-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vLan
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-forged_transmits
        towhat: Host
        file_mtime: 
        guid: f246e3e0-fee1-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vlans.
        read_only: 
      - name: a3ac5774-fee1-11de-83dd-005056ba5e76
        description: Forged Transmits Disabled in vSwitch
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-forged_transmits
        towhat: Host
        file_mtime: 
        guid: a3ac5774-fee1-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000022
        notes: This condition verifies that forged transmits are disabled on vSwitches.
        read_only: 
    - name: 8d4a7bee-fa56-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers defined in step-tickers
      expression: 
      towhat: Host
      guid: 8d4a7bee-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        step-tickers configuration.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 0806448a-fa57-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in step-tickers File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: |
                    count = 0
                    context.each_line { |line|                              # Break up the input by lines
                      count += 1 if line =~ /^[^#]*server\s+[0-9A-Za-z]+/   # Increment Count if line matches our regular expression
                    }
                    return true if count >= 3
                    return false
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ntp/step-tickers"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 0806448a-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000023
        notes: This condition checks the file /etc/ntp/step-tickers and verifies that
          a minimum of three ntp servers are defined.
        read_only: 
    - name: ab373d88-fa4a-11de-83ca-005056ba0614
      description: Settings - Display Logs on Different Terminals
      expression: 
      towhat: Host
      guid: ab373d88-fa4a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that critical, error, and warning level log messages
        are directed to distinct terminals.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: f383ec6c-fa4a-11de-83ca-005056ba0614
        description: Verify Different Logs Displayed on Different Terminals
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: "^\\s*\\*\\.crit\\s+\\/dev\\/tty"
                    field: Host.filesystems-contents
                search:
                  "=":
                    value: "/etc/syslog.conf"
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: "^\\s*\\*\\.err\\s+\\/dev\\/tty"
                    field: Host.filesystems-contents
                search:
                  "=":
                    value: "/etc/syslog.conf"
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: "^\\s*\\*\\.warning\\s+\\/dev\\/tty"
                    field: Host.filesystems-contents
                search:
                  "=":
                    value: "/etc/syslog.conf"
                    field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: f383ec6c-fa4a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000024
        notes: This condition checks the file /etc/syslog.conf has three seperate
          parameters defined for critical, error, and warning level log messages.
          These parameters specify the tty will display the specified log messages.
        read_only: 
    - name: 498f5330-fa4b-11de-83ca-005056ba0614
      description: Settings -  Remote syslog Logging
      expression: 
      towhat: Host
      guid: 498f5330-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that syslog is configured to utilize a remote server.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: ee09af6e-fa4b-11de-83ca-005056ba0614
        description: Verify syslog Utilizes a Remote Host
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "/^[^#*]\\s*.*@/"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/syslog.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: ee09af6e-fa4b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000025
        notes: This condition checks the file /etc/syslog.conf and verifies the existence
          of the @ parameter, which is used to specify the use of a remote server.
        read_only: 
    - name: eb0151ea-fa47-11de-83ca-005056ba0614
      description: Root Login on console should be Disabled
      expression: 
      towhat: Host
      guid: eb0151ea-fa47-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot directly login via
        the console.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 571e6e76-fa48-11de-83ca-005056ba0614
        description: File /etc/securetty should be empty
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkall:
                "=":
                  value: '0'
                  field: Host.filesystems-size
              search:
                "=":
                  value: "/etc/securetty"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 571e6e76-fa48-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000026
        notes: This condition checks the file /etc/securetty and verifies that it's
          empty by checking for a 0KB file size.
        read_only: 
    - name: e4c93c82-fa3a-11de-83ca-005056ba0614
      description: Permissions - /etc/grub.conf
      expression: 
      towhat: Host
      guid: e4c93c82-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that editing the server's boot process requires
        root level authority.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: d2adb400-fa3b-11de-83ca-005056ba0614
        description: Permissions - /etc/grub.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  "=":
                    value: '0600'
                    field: Host.filesystems-permissions
                search:
                  "=":
                    value: "/etc/grub.conf"
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  "=":
                    value: root
                    field: Host.filesystems-owner
                search:
                  "=":
                    value: "/etc/grub.conf"
                    field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: d2adb400-fa3b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000027
        notes: This condition verifies that the file /etc/grub.conf's permissions
          are set to 0600 and is owned by root.
        read_only: 
    - name: de683aa6-fedf-11de-83dd-005056ba5e76
      description: Network - Mac Changes not Allowed
      expression: 
      towhat: Host
      guid: de683aa6-fedf-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: This policy checks that MAC changes are not allowed on vSwitches and
        vLans.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vLans
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.lans-mac_changes
        towhat: Host
        file_mtime: 
        guid: 3ed9fb4a-fee0-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vLans.
        read_only: 
      - name: 0a6eb332-fee0-11de-83dd-005056ba5e76
        description: Mac Changes Disabled in vSwitches
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'false'
                field: Host.switches-mac_changes
        towhat: Host
        file_mtime: 
        guid: 0a6eb332-fee0-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000028
        notes: This condition verifies that MAC changes are not allowed on vSwitches.
        read_only: 
    - name: 7cc14778-fe0f-11de-83dd-005056ba5e76
      description: Network - Promiscuous Mode Setting Not Disabled
      expression: 
      towhat: Host
      guid: 7cc14778-fe0f-11de-83dd-005056ba5e76
      created_by: admin
      updated_by: admin
      notes: Check the Host VLan setting for Promiscuous Mode which should be disabled.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 2045b314-fe58-11de-83dd-005056ba5e76
        description: Check Host vSwitch - Promiscuous Mode Must Not Be Enable
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'true'
                field: Host.switches-allow_promiscuous
        towhat: Host
        file_mtime: 
        guid: 2045b314-fe58-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000029
        notes: This condition verifies that vSwitches do not allow Promiscuous mode
          via inheritance.
        read_only: 
      - name: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        description: Check Host Port - Promiscuous Mode Must Not Be Enabled
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            not:
              CONTAINS:
                value: 'true'
                field: Host.lans-computed_allow_promiscuous
        towhat: Host
        file_mtime: 
        guid: 80e5ff5e-fe16-11de-83dd-005056ba5e76
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000029
        notes: This condition verifies that vLans do not allow Promiscuous mode via
          inheritance.
        read_only: 
    - name: a8e0ef7c-fa48-11de-83ca-005056ba0614
      description: Use sudo aliases
      expression: 
      towhat: Host
      guid: a8e0ef7c-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that user aliases are enabled in the configuration
        of the sudo command.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 99496ebc-fa49-11de-83ca-005056ba0614
        description: Aliases are being used for sudo authorization
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*User_Alias"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/sudoers"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 99496ebc-fa49-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000030
        notes: This condition checks the file /etc/sudoers and verifies that the parameter
          "User_Alias" is defined.
        read_only: 
    - name: 4ed279b2-fa55-11de-83ca-005056ba0614
      description: Timekeeping - NTP Service Running
      expression: 
      towhat: Host
      guid: 4ed279b2-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the NTP servers is configured to automatically
        start.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 9a08d21e-fa55-11de-83ca-005056ba0614
        description: Verify NTP is Running
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                INCLUDES:
                  value: '3'
                  field: Host.host_services-enable_run_levels
              search:
                "=":
                  value: ntpd
                  field: Host.host_services-name
        towhat: Host
        file_mtime: 
        guid: 9a08d21e-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000031
        notes: This condition verifies that the run level of the service ntpd is set
          to three.
        read_only: 
    - name: a6c2a51e-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in ntp.conf
      expression: 
      towhat: Host
      guid: a6c2a51e-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 servers are defined in the NTP
        configuration.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 03c821bc-fa58-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in ntp.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: |-
                    count = 0
                    context.each_line { |line|                              # Break up the input by lines
                      count += 1 if line =~ /^[^#]*server\s+[0-9A-Za-z]+/   # Increment Count if line matches our regular expression
                    }
                    return true if count >= 3
                    return false
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ntp.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 03c821bc-fa58-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000032
        notes: This condition checks the file /etc/ntp.conf and verifies that a minimum
          of three ntp servers are defined.
        read_only: 
    - name: c4396f3a-fa55-11de-83ca-005056ba0614
      description: Timekeeping - Minimum of 3 NTP Servers Defined in hosts
      expression: 
      towhat: Host
      guid: c4396f3a-fa55-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a minimum of 3 NTP servers are defined in the
        local hosts file.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 2698c39c-fa56-11de-83ca-005056ba0614
        description: Verify 3 NTP Servers Defined in hosts File
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                RUBY:
                  value: |
                    count = 0
                    context.each_line { |line|                              # Break up the input by lines
                      count += 1 if line =~ /^[^#]*NTP/i   # Increment Count if line matches our regular expression
                    }
                    return true if count >= 3
                    return false
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/hosts"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 2698c39c-fa56-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000033
        notes: 'This conditions checks the file /etc/hosts and veries that there are
          at least 3 uncommented lines that reference ntp servers. The included expression
          can be modified to match the appropriate values for the ntp servers for
          your environment.

'
        read_only: 
    - name: 3819638c-fa57-11de-83ca-005056ba0614
      description: Timekeeping - Drift Enabled
      expression: 
      towhat: Host
      guid: 3819638c-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP's driftfile support is enabled.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 71fae5da-fa57-11de-83ca-005056ba0614
        description: Verify NTP Uses a Driftfile
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*driftfile\\s+\\/var\\/lib\\/ntp\\/drift"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ntp.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 71fae5da-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000034
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          driftfile parameter exists.
        read_only: 
    - name: ebc02cea-fa57-11de-83ca-005056ba0614
      description: Time Keeping - Restrict Access for Machines without Loopback
      expression: 
      towhat: Host
      guid: ebc02cea-fa57-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that only non-loopback machines can access the NTP
        service.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: ddc26260-fa58-11de-83ca-005056ba0614
        description: Access Restricted for Machines without Loopback
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*restrict\\s+default\\s+kod\\s+nomodify\\s+notrap"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ntp.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: ddc26260-fa58-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000035
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          line "restrict default kod nomodify notrap" exists.
        read_only: 
    - name: ccadf9fa-fa56-11de-83ca-005056ba0614
      description: Time Keeping - NTP Configured to Use Loopback Adapter
      expression: 
      towhat: Host
      guid: ccadf9fa-fa56-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that NTP performs all name resolutions via a loopback
        network.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        description: NTP Configured to Use Loopback Adapter
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*restrict\\s+127\\.0\\.0\\.1"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ntp.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 2b9bb8b2-fa57-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000036
        notes: This condition checks the file /etc/ntp.conf and verifies that the
          restrict parameter's value is set to 127.0.0.1.
        read_only: 
    - name: 4614d62e-fa52-11de-83ca-005056ba0614
      description: Settings - vmkwarning Compress Option
      expression: 
      towhat: Host
      guid: 4614d62e-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkwarning log is compressed by default.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: a51cbaba-fa52-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkwarning
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "\\s+compress"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmkwarning"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: a51cbaba-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000037
        notes: This condition checks the file /etc/logrotate.d/vmkwarning and verifies
          that the option compress is enabled.
        read_only: 
    - name: 6353b57e-fa53-11de-83ca-005056ba0614
      description: Settings - vmksummary Compress Option
      expression: 
      towhat: Host
      guid: 6353b57e-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmksummary log is compressed by default.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 510f7286-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmksummary
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "\\s+compress"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmksummary"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 510f7286-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000038
        notes: This condition checks the file /etc/logrotate.d/vmksummary and verifies
          that the option compress is enabled.
        read_only: 
    - name: 0864fae6-fa54-11de-83ca-005056ba0614
      description: Settings - vmkernel Compress Option
      expression: 
      towhat: Host
      guid: 0864fae6-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the vmkernel log is compressed by default.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: fe7378be-fa53-11de-83ca-005056ba0614
        description: Verify Compression Enabled in vmkernel
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "\\s+compress"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmkernel"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: fe7378be-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000039
        notes: This condition checks the file /etc/logrotate.d/vmkernel and verifies
          that the option compress is enabled.
        read_only: 
    - name: 6576a074-fa48-11de-83ca-005056ba0614
      description: Settings - /etc/sudoers
      expression: 
      towhat: Host
      guid: 6576a074-fa48-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use syslog for logging.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: ade186c6-fa48-11de-83ca-005056ba0614
        description: Verify sudo is Logging via syslog
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*Defaults\\s+syslog\\="
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/sudoers"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: ade186c6-fa48-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000040
        notes: This condition check the file /etc/sudoers and verifies that the parameter
          "Defaults syslog=" exists.
        read_only: 
    - name: c340f524-fa3e-11de-83ca-005056ba0614
      description: Settings - /etc/grub.conf
      expression: 
      towhat: Host
      guid: c340f524-fa3e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that a password is required in order to edit the
        server's boot process.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 1f18225a-fa3f-11de-83ca-005056ba0614
        description: Verify /etc/grub.conf Settings
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*password\\s\\-\\-md5"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/grub.conf"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 1f18225a-fa3f-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000041
        notes: This condition check the file /etc/grub.conf and verifies that the
          parameter "password --md5" exists.
        read_only: 
    - name: c63b0560-fa45-11de-83ca-005056ba0614
      description: Root Login via SSH should be Disabled
      expression: 
      towhat: Host
      guid: c63b0560-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the root account cannot login to the host via
        SSH.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 4435b6d6-fa46-11de-83ca-005056ba0614
        description: PermitRootLogin = no in sshd_config file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*PermitRootLogin\\s+no"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/ssh/sshd_config"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 4435b6d6-fa46-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000042
        notes: This condition checks the file /etc/ssh/sshd_config and verifies that
          the PermitRootLogin parameter's value is set to no.
        read_only: 
    - name: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      description: Require users to enter own password - no ROOTPW entry
      expression: 
      towhat: Host
      guid: 5ce6be9a-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that when the sudo command is used, each user is
        prompted for their password and not the root password.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: a791b882-fa4c-11de-83ca-005056ba0614
        description: ROOTPW does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: "/^[^#]*ROOTPW/i"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/sudoers"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: a791b882-fa4c-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000043
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word ROOTPW on an uncommented line.
        read_only: 
    - name: a128d356-fa36-11de-83ca-005056ba0614
      description: Protect Root File System Filling /tmp
      expression: 
      towhat: Host
      guid: a128d356-fa36-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /tmp directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 267dd9de-fa37-11de-83ca-005056ba0614
        description: Protect Root File System Filling  /tmp
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^[^#]*\\/tmp"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/fstab"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 267dd9de-fa37-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000044
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /tmp.
        read_only: 
    - name: 7ea7db8c-fa46-11de-83ca-005056ba0614
      description: Permissions - /etc/snmp/snmpd.conf
      expression: 
      towhat: Host
      guid: 7ea7db8c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy ensures that access to SNMP configuration parameters are
        limited to the root user.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: ebb24a50-fa46-11de-83ca-005056ba0614
        description: Permissions - /etc/snmp/snmpd.conf
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  "=":
                    value: '0700'
                    field: Host.filesystems-permissions
                search:
                  "=":
                    value: "/etc/snmp/snmpd.conf"
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  "=":
                    value: root
                    field: Host.filesystems-owner
                search:
                  "=":
                    value: "/etc/snmp/snmpd.conf"
                    field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: ebb24a50-fa46-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000045
        notes: This condition verifies that the permissions of /etc/snmp/snmpd.conf
          are 0700 and is owned by root.
        read_only: 
    - name: 40b796dc-fa50-11de-83ca-005056ba0614
      description: Password Expiration Warning Default
      expression: 
      towhat: Host
      guid: 40b796dc-fa50-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the default setting for password expiration warning.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 0e842bde-fa51-11de-83ca-005056ba0614
        description: Password Expiration Warning Default >= 7days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*PASS_WARN_AGE\\s+([7-9]|[1-9][0-9]+)"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/login.defs"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 0e842bde-fa51-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000046
        notes: This condition checks the file /etc/login.defs and verifies that PASS_WARN_AGE
          parameter's value is set to 7 or greater.
        read_only: 
    - name: 2f9fad14-fa4e-11de-83ca-005056ba0614
      description: Password Aging - Default Maximum
      expression: 
      towhat: Host
      guid: 2f9fad14-fa4e-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's maximum password age configuration.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: a4a0e740-fa4e-11de-83ca-005056ba0614
        description: Default Maximum Password Age <= 90days
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*PASS_MAX_DAYS\\s+([0-9]|[1-8][0-9]|90)"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/login.defs"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: a4a0e740-fa4e-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000047
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MAX_DAYS parameter's value is 90 days or greater.
        read_only: 
    - name: 79548666-fa51-11de-83ca-005056ba0614
      description: Limit vmkwarning Size
      expression: 
      towhat: Host
      guid: 79548666-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkwarning log is limited to a specified size.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 14d35e46-fa52-11de-83ca-005056ba0614
        description: vmkwarning Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*size\\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\\d{1,3})k"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmkwarning"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 14d35e46-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000048
        notes: This condition verifies that the file /etc/logrotate.d/vmkwarning is
          configured to limit the associated log to 4096KB.
        read_only: 
    - name: c79821fa-fa53-11de-83ca-005056ba0614
      description: Limit vmkernel Size
      expression: 
      towhat: Host
      guid: c79821fa-fa53-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmkernel log is limited to a specified size.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: be9722e0-fa53-11de-83ca-005056ba0614
        description: vmkernel Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*size\\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\\d{1,3})k"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmkernel"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: be9722e0-fa53-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000049
        notes: This condition verifies that the file /etc/logrotate.d/vmkernel is
          configured to limit the associated log to 4096KB.
        read_only: 
    - name: 8cecc84c-fa46-11de-83ca-005056ba0614
      description: Limit su Access to root Account
      expression: 
      towhat: Host
      guid: 8cecc84c-fa46-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only members of the group wheel can access
        the su command.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 63b243fc-fa47-11de-83ca-005056ba0614
        description: Only members of wheel group can execute su command
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*auth\\s+required\\s+.*pam_wheel\\.so\\s+use_uid"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/pam.d/su"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 63b243fc-fa47-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000050
        notes: This condition validates that the file /etc/pam.d/su contains a variation
          of the string "auth required pam_wheel.so use_uid".
        read_only: 
    - name: 2cd1b736-fa52-11de-83ca-005056ba0614
      description: Limit Software and Services Running in Service Console
      expression: 
      towhat: Host
      guid: 2cd1b736-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that only an approved list of services are enabled
        at boot time on an ESX host.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: c4c80bfa-fa55-11de-83ca-005056ba0614
        description: Default Services Running in Service Console
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            LIMITED TO:
              value: crond, firewall, gpm, ipmi, irqbalance, mgmt-vmware, microcode_ctl,
                mptctlnode, network, ntpd, pegasus, portmap, random, rawdevices, sshd,
                syslog, vmware, vmware-autostart, vmware-late, vmware-vmkauthd, vmware-vpxa,
                vmware-webAccess, wsman, xinetd
              field: Host-enabled_run_level_3_services
        towhat: Host
        file_mtime: 
        guid: c4c80bfa-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000051
        notes: This conditions validates that a defined list of services are enabled
          with the ESX host is booted with networking support (run level 3). This
          list includes the generic services included in ESX. Additional hardware
          specific services can be added to the expression.
        read_only: 
    - name: edaf1082-fa54-11de-83ca-005056ba0614
      description: Firewall - Outgoing NTP Port
      expression: 
      towhat: Host
      guid: edaf1082-fa54-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates that the Firewall is configured properly for NTP
        support.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        description: Valid NTP Outgoing UDP Port
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            INCLUDES ANY:
              value: '123'
              field: Host-enabled_udp_outbound_ports
        towhat: Host
        file_mtime: 
        guid: 1cb7f0ba-fa55-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000052
        notes: This condition verifies that the outgoing UDP port required by NTP
          (port 123) is open.
        read_only: 
    - name: 0f2cc826-fa4b-11de-83ca-005056ba0614
      description: Directory Service Used for Authentication for sudo
      expression: 
      towhat: Host
      guid: 0f2cc826-fa4b-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that sudo is configured to use a directory for user
        authentication.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 684b2a60-fa4b-11de-83ca-005056ba0614
        description: Directory Service used for sudo authentication
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*auth\\s+required\\s+.*pam_stack\\.so\\s+service=system-auth"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/pam.d/sudo"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 684b2a60-fa4b-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000053
        notes: 'This condition verifies that the line "auth required pam_stack.so
          service=system-auth" exists in /etc/pam.d/sudo. '
        read_only: 
    - name: 4b188948-fa45-11de-83ca-005056ba0614
      description: Settings - SNMP Read Only Access
      expression: 
      towhat: Host
      guid: 4b188948-fa45-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that SNMP is configured to only allow read-only
        access.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: e328c720-fa45-11de-83ca-005056ba0614
        description: SNMP Configured for Read-only Access
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            and:
            - FIND:
                checkany:
                  REGULAR EXPRESSION MATCHES:
                    value: "^\\s*rocommunity"
                    field: Host.filesystems-contents
                search:
                  "=":
                    value: "/etc/snmp/snmpd.conf"
                    field: Host.filesystems-name
            - FIND:
                checkany:
                  REGULAR EXPRESSION DOES NOT MATCH:
                    value: "^\\s*rwcommunity"
                    field: Host.filesystems-contents
                search:
                  "=":
                    value: "/etc/snmp/snmpd.conf"
                    field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: e328c720-fa45-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000054
        notes: This condition checks the file /etc/snmp/snmpd.conf and verfies that
          the rocommunity parameter is defined and the rwcommunity parameter is not.
        read_only: 
    - name: 854d45aa-fa3a-11de-83ca-005056ba0614
      description: Protect Root File System Filling /var/log
      expression: 
      towhat: Host
      guid: 854d45aa-fa3a-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that the /var/log directory is mounted on a different
        partition than the root filesystem.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: a84173e2-fa3a-11de-83ca-005056ba0614
        description: Protect Root File System Filling /var/log
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^[^#]*\\/var\\/log"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/fstab"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: a84173e2-fa3a-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000055
        notes: This condition verifies that the file /etc/fstab has an uncommented
          line that references the directory /var/log.
        read_only: 
    - name: fc63df74-fa52-11de-83ca-005056ba0614
      description: Limit vmksummary Size
      expression: 
      towhat: Host
      guid: fc63df74-fa52-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy checks the vmksummary log is limited to a specified size.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: def33840-fa52-11de-83ca-005056ba0614
        description: vmksummary Log Size <= 4096KB
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*size\\s+(409[0-6]|40[0-8][0-9]|[123][0-9]{3}|\\d{1,3})k"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/logrotate.d/vmksummary"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: def33840-fa52-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000056
        notes: This condition verifies that the file /etc/logrotate.d/vmksummary is
          configured to limit the associated log to 4096KB.
        read_only: 
    - name: 305e6832-fa51-11de-83ca-005056ba0614
      description: Password Complexity - Minimum Length
      expression: 
      towhat: Host
      guid: 305e6832-fa51-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies the minimum password length.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: c0ba559e-fa51-11de-83ca-005056ba0614
        description: Minimum Password Length >= 8
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*PASS_MIN_LEN\\s+([8-9]|[1-9][0-9]+)"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/login.defs"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: c0ba559e-fa51-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000057
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_LEN parameter's value  is 8 or greater.
        read_only: 
    - name: e6f082ba-fa4c-11de-83ca-005056ba0614
      description: Password checking enabled for sudo
      expression: 
      towhat: Host
      guid: e6f082ba-fa4c-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy verifies that password checking is enabled for sudo.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 3d2074e2-fa4d-11de-83ca-005056ba0614
        description: NOPASSWD does not exist in sudoers file
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION DOES NOT MATCH:
                  value: "/^[^#]*NOPASSWD/i"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/sudoers"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 3d2074e2-fa4d-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000058
        notes: This condition check the file /etc/sudoers and verifies that it does
          not contain the word NOPASSWORD on an uncommented line.
        read_only: 
    - name: 32b26f2c-fa4f-11de-83ca-005056ba0614
      description: Password Aging - Default Minimum
      expression: 
      towhat: Host
      guid: 32b26f2c-fa4f-11de-83ca-005056ba0614
      created_by: admin
      updated_by: admin
      notes: This policy validates the ESX host's minimum password age configuration.
      active: true
      mode: compliance
      read_only: 
      MiqPolicyContent:
      - qualifier: failure
        failure_sequence: 1
        MiqEventDefinition:
          name: host_compliance_check
          description: Host Compliance Check
          guid: b9abe0a8-f586-11de-8ebc-0050568a07c7
          event_type: Default
          definition: 
          default: 
          enabled: 
        MiqAction:
          name: compliance_failed
          description: Mark as Non-Compliant
          guid: 339f0cc8-317e-11e3-88e1-005056b80000
          action_type: default
          options: {}
      Condition:
      - name: 79d39ad4-fa4f-11de-83ca-005056ba0614
        description: Default Minimum Password Age >= 0
        modifier: allow
        expression: !ruby/object:MiqExpression
          exp:
            FIND:
              checkany:
                REGULAR EXPRESSION MATCHES:
                  value: "^\\s*PASS_MIN_DAYS\\s+\\d+"
                  field: Host.filesystems-contents
              search:
                "=":
                  value: "/etc/login.defs"
                  field: Host.filesystems-name
        towhat: Host
        file_mtime: 
        guid: 79d39ad4-fa4f-11de-83ca-005056ba0614
        filename: 
        applies_to_exp: 
        miq_policy_id: 10000000000059
        notes: This condition checks the file /etc/login.defs and verifies that the
          PASS_MIN_DAYS parameter's value is greater than or equal to 0 days.
        read_only: 
